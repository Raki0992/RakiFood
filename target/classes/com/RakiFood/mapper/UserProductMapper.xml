<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	<mapper namespace="com.RakiFood.mapper.UserProductMapper">
	
	<!-- CDATA 섹션(xml에 문법사용가능하게 함) parameter 2개이상시 map으로 처리-->
	<select id="pro_list" resultType="com.RakiFood.domain.ProductVO" parameterType="map">	
	<![CDATA[
	select 
		PRO_NUM, CG_CODE, PRO_NAME, PRO_PRICE, PRO_DISCOUNT, PRO_PUBLISHER, PRO_CONTENT, PRO_UP_FOLDER, PRO_IMG, PRO_AMOUNT, PRO_BUY, PRO_DATE, PRO_UPDATEDATE
	from 
		(
		select/*+INDEX_DESC(PRODUCT_TBL pk_pro_num)*/
            rownum rn, PRO_NUM, CG_CODE, PRO_NAME, PRO_PRICE, PRO_DISCOUNT, PRO_PUBLISHER, PRO_CONTENT, PRO_UP_FOLDER, PRO_IMG, PRO_AMOUNT, PRO_BUY, PRO_DATE, PRO_UPDATEDATE
		from 
            PRODUCT_TBL	
		where 
			cg_code = #{cg_code}
			AND
			rownum <= #{cri.pageNum} * #{cri.amount}
		)
		where
			rn > (#{cri.pageNum} -1) * #{cri.amount} 
		 ]]>
	</select>
	
	<select id="getTotalCount" resultType="int">
		SELECT 
			COUNT(*) 
		FROM 
			PRODUCT_TBL
		WHERE
		 	cg_code = #{cg_code}
	</select>
	
	<select id="pro_detail" resultType="com.RakiFood.domain.ProductVO">
		SELECT 
			PRO_NUM, CG_CODE, PRO_NAME, PRO_PRICE, PRO_DISCOUNT, PRO_PUBLISHER, PRO_CONTENT, PRO_UP_FOLDER, PRO_IMG, PRO_AMOUNT, PRO_BUY, PRO_DATE, PRO_UPDATEDATE
		FROM 
			PRODUCT_TBL
		WHERE
		 	PRO_NUM = #{pro_num}
	</select>
	
	<select id="buy_now" resultType="com.RakiFood.domain.ProductVO">	pro_num
		SELECT
			 C.RFCART_CODE, C.PRO_NUM, C.RFCART_AMOUNT, P.PRO_NAME, P.PRO_PRICE, P.PRO_IMG, P.PRO_DISCOUNT, P.PRO_UP_FOLDER
		FROM
			PRODUCT_TBL P INNER JOIN RF_CART_TBL C 
		ON
			P.PRO_NUM = C.PRO_NUM
		WHERE
			C.RAKI_ID = #{raki_id}
	</select>
	
	<select id="">	장바구니
	
	SELECT
			P.PRO_NAME, P.PRO_PRICE, P.PRO_IMG, P.PRO_DISCOUNT, P.PRO_UP_FOLDER
		FROM
			PRODUCT_TBL P
		WHERE
			C.RAKI_ID = #{raki_id}
	</select>
	
	</mapper>